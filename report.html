
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NSSC1 Numerical Methods for Ordinary Differential Equations Exercises Part 1 &#8212; ASC-ODE</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'report';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-light" alt="ASC-ODE - Home"/>
    <script>document.write(`<img src="_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-dark" alt="ASC-ODE - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    NSSC1 Numerical Methods for Ordinary Differential Equations Exercises Part 1
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/e11717655/ASC-ODE-Team13" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/report.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>NSSC1 Numerical Methods for Ordinary Differential Equations Exercises Part 1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">NSSC1 Numerical Methods for Ordinary Differential Equations Exercises Part 1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#explicit-euler-method">Explicit Euler Method</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-euler-method">Implicit Euler Method</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#improved-euler-method">Improved Euler Method</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#crank-nicolson-method">Crank-Nicolson Method</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-plots">Interpretation of Plots</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="nssc1-numerical-methods-for-ordinary-differential-equations-exercises-part-1">
<h1>NSSC1 Numerical Methods for Ordinary Differential Equations Exercises Part 1<a class="headerlink" href="#nssc1-numerical-methods-for-ordinary-differential-equations-exercises-part-1" title="Link to this heading">#</a></h1>
<p>For this exercise, we compared several different time-stepping methods for a mass attached to a spring, this is described by the ODE:</p>
<div class="math notranslate nohighlight">
\[m y''(t) = -k y(t)\]</div>
<p>giving us a simple harmonic oscilator system, with <span class="math notranslate nohighlight">\(k\)</span> as the spring constant, <span class="math notranslate nohighlight">\(m\)</span> as the mass, and <span class="math notranslate nohighlight">\(y(t)\)</span> as displacement.
This second-order equation can be replaced with the first order system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
y_{0}^{\prime} = y_{1} \\
y_{1}^{\prime} = - \frac{k}{m} y_{0}
\end{split}\]</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MassSpring</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">NonlinearFunction</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">m_mass</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">m_stiffness</span><span class="p">;</span>
<span class="w">  </span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">MassSpring</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">m_mass</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="w"> </span><span class="n">m_stiffness</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dimX</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dimF</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">evaluate</span><span class="w"> </span><span class="p">(</span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">m_stiffness</span><span class="o">/</span><span class="n">m_mass</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">evaluateDeriv</span><span class="w"> </span><span class="p">(</span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">MatrixView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">    </span><span class="n">df</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">df</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">m_stiffness</span><span class="o">/</span><span class="n">m_mass</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Once this system has been set up they can be solved using various timestep methods.</p>
<p>These methods are implemented by modifying the base class <code class="docutils literal notranslate"><span class="pre">TimeStepper</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TimeStepper</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">protected</span><span class="o">:</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_rhs</span><span class="p">;</span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">TimeStepper</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rhs</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m_rhs</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">TimeStepper</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doStep</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="w"> </span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="explicit-euler-method">
<h1>Explicit Euler Method<a class="headerlink" href="#explicit-euler-method" title="Link to this heading">#</a></h1>
<p>The first time step method is the Explicit Euler Method. It is an explicit, one-step method where the ODE</p>
<div class="math notranslate nohighlight">
\[
y^{\prime}(t) = f(y(t)) \quad \forall t \in [0,T], \quad y(0) = y_{0}
\]</div>
<p>is solved by using this method:</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_{i} + \tau f(y_{i}) \quad \text{for } 0 \leq i &lt; n
\]</div>
<p>with <span class="math notranslate nohighlight">\(\tau = T/n\)</span>. The error of this method is proptional to the step size, making it have first order accuracy <span class="math notranslate nohighlight">\(O(\tau)\)</span>. The method is only conditionally stable, and when utilized for a pure harmonic oscilator, as it was in this case, it is not stable as energy is added to the system causing the amplitude of the oscillations to increase.</p>
<p>The class <code class="docutils literal notranslate"><span class="pre">ExplicitEuler</span></code> looks like this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ExplicitEuler</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TimeStepper</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">Vector</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">ExplicitEuler</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rhs</span><span class="p">)</span>
<span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">TimeStepper</span><span class="p">(</span><span class="n">rhs</span><span class="p">),</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimF</span><span class="p">())</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">doStep</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="w"> </span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_rhs</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">);</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Here the base class is updated by modifying the <code class="docutils literal notranslate"><span class="pre">doStep</span></code> function. It now takes <code class="docutils literal notranslate"><span class="pre">tau</span></code> and <code class="docutils literal notranslate"><span class="pre">m_vectf</span></code> as inputs and then updates the state vector by adding them.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="implicit-euler-method">
<h1>Implicit Euler Method<a class="headerlink" href="#implicit-euler-method" title="Link to this heading">#</a></h1>
<p>Next up, we had to try out the Implicit Euler Method. Compared to the explicit Euler method, the implicit Euler Method is more computationally expensive, due to it having to solve a potentially nonlinear equation for <span class="math notranslate nohighlight">\(y_i+1\)</span>. This is done using a built in Newton Solver. The method is also first-order accurate, with the error decreasing linearly with step size <span class="math notranslate nohighlight">\(\tau\)</span>. However, this method is both A-stable and L-stable. It has a dampening effect built in which causes the oscillations to decay over time, despite not having any friction defined in the system.</p>
<p>The Method is defined by</p>
<div class="math notranslate nohighlight">
\[
\frac{y_{i+1} - y_i}{t_{i+1} - t_i} = f(t_{i+1}, y_{i+1})
\]</div>
<p>or it can be rewritten as</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i + \tau\, f(t_{i+1}, y_{i+1}), \qquad 0 \le i &lt; n
\]</div>
<p>The code was already provided. The implementation utilized was</p>
<div class="math notranslate nohighlight">
\[
y - y_{old} - τf(y) = 0
\]</div>
<p>with the provided class</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ImplicitEuler</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TimeStepper</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_equ</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Parameter</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_tau</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">ConstantFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_yold</span><span class="p">;</span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">ImplicitEuler</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rhs</span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">TimeStepper</span><span class="p">(</span><span class="n">rhs</span><span class="p">),</span><span class="w"> </span><span class="n">m_tau</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">m_yold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ConstantFunction</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimX</span><span class="p">());</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">ynew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">IdentityFunction</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimX</span><span class="p">());</span>
<span class="w">      </span><span class="n">m_equ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ynew</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m_yold</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m_tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m_rhs</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">DoStep</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="w"> </span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">m_yold</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="w">      </span><span class="n">m_tau</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">tau</span><span class="p">);</span>
<span class="w">      </span><span class="n">NewtonSolver</span><span class="p">(</span><span class="n">m_equ</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="improved-euler-method">
<h1>Improved Euler Method<a class="headerlink" href="#improved-euler-method" title="Link to this heading">#</a></h1>
<p>This method involved modifying the <code class="docutils literal notranslate"><span class="pre">ExplicitEuler</span></code> time-stepping method by replacing the time steps with</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\tilde{y} = y _n + \frac{τ}{2}f(y_n) \\
y_{n+1} = y_{n} + τf(\tilde{y})
\end{split}\]</div>
<p>This method is also explicit, however it is second-order <span class="math notranslate nohighlight">\(O(τ^{2}))\)</span> accurate, causing the error to decrease in proportion to the square of the timestep. It is still not stable, and also does not need a <code class="docutils literal notranslate"><span class="pre">NewtonSolver</span></code> as it only requires two function evaluations.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ImprovedEuler</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TimeStepper</span><span class="p">{</span>
<span class="w">    </span><span class="n">Vector</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">;</span>
<span class="w">    </span><span class="n">Vector</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">halfway</span><span class="p">;</span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">ImprovedEuler</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rhs</span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">TimeStepper</span><span class="p">(</span><span class="n">rhs</span><span class="p">),</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimF</span><span class="p">()),</span><span class="w"> </span><span class="n">halfway</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimX</span><span class="p">())</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">DoStep</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="w"> </span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_rhs</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">);</span>
<span class="w">      </span><span class="n">halfway</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">      </span><span class="n">halfway</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">tau</span><span class="p">)</span><span class="o">*</span><span class="n">m_vecf</span><span class="p">;</span>

<span class="w">      </span><span class="n">m_rhs</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">halfway</span><span class="p">,</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">);</span>
<span class="w">      </span><span class="n">y</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m_vecf</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>
</pre></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="crank-nicolson-method">
<h1>Crank-Nicolson Method<a class="headerlink" href="#crank-nicolson-method" title="Link to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">CrankNicolson</span></code> class was implemented by modifying the <code class="docutils literal notranslate"><span class="pre">ImplicitEuler</span></code> class. They both rely on the <code class="docutils literal notranslate"><span class="pre">NewtonStepper</span></code> as they are implicit methods, the difference however, is in the way the steps are calculated</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i + \frac{τ}{2}(f(t_i, y_i) + f(t_{i+1}, y_{i+1}) \qquad 0 \le i &lt; n
\]</div>
<p>This method is a one-step method. It utilizes the trapezoidal integration rule for the formulation of the steps and has second-order accuracy. It is A-stable, and unlike the implicit Euler Method it is energy conserving, meaning that the oscillations will continue without decay or explostion (Explicit Euler).</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CrankNicolson</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">TimeStepper</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_equ</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Parameter</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_tau</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">ConstantFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_yold</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">ConstantFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m_f_old</span><span class="p">;</span>

<span class="w">  </span><span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">CrankNicolson</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">NonlinearFunction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rhs</span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">TimeStepper</span><span class="p">(</span><span class="n">rhs</span><span class="p">),</span><span class="w"> </span><span class="n">m_tau</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">m_yold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ConstantFunction</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimX</span><span class="p">());</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">ynew</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">IdentityFunction</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimX</span><span class="p">());</span>
<span class="w">      </span><span class="n">m_fold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ConstantFunction</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">dimX</span><span class="p">());</span>
<span class="w">      </span><span class="n">m_equ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ynew</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m_yold</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">m_tau</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">m_rhs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m_fold</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">DoStep</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="w"> </span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fy_val</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">      </span><span class="n">m_rhs</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">fy_val</span><span class="p">);</span>
<span class="w">      </span>
<span class="w">      </span><span class="n">m_fold</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">fy_val</span><span class="p">);</span>
<span class="w">      </span><span class="n">m_yold</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">y</span><span class="p">);</span><span class="w">       </span>
<span class="w">      </span><span class="n">m_tau</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">tau</span><span class="p">);</span><span class="w">      </span>

<span class="w">      </span><span class="n">NewtonSolver</span><span class="p">(</span><span class="n">m_equ</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>
</pre></div>
</div>
<section id="interpretation-of-plots">
<h2>Interpretation of Plots<a class="headerlink" href="#interpretation-of-plots" title="Link to this heading">#</a></h2>
<p>10 Steps</p>
<p><a class="reference internal" href="_images/phase_plot_10_12.57.png"><img alt="_images/phase_plot_10_12.57.png" src="_images/phase_plot_10_12.57.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_10_12.57.png"><img alt="_images/time_evo_10_12.57.png" src="_images/time_evo_10_12.57.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 10 steps, end time 12.57.</p>
<p><a class="reference internal" href="_images/phase_plot_10_62.83.png"><img alt="_images/phase_plot_10_62.83.png" src="_images/phase_plot_10_62.83.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_10_62.83.png"><img alt="_images/time_evo_10_62.83.png" src="_images/time_evo_10_62.83.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 10 steps, end time 62.83.</p>
<p><a class="reference internal" href="_images/phase_plot_10_314.16.png"><img alt="_images/phase_plot_10_314.16.png" src="_images/phase_plot_10_314.16.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_10_314.16.png"><img alt="_images/time_evo_10_314.16.png" src="_images/time_evo_10_314.16.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 10 steps, end time 314.16.</p>
<ol class="arabic simple">
<li><p><strong>Large step sizes (τ = 10)</strong><br />
For large time steps, the numerical method introduces significant deformation in the phase plot.<br />
The the phase plots become heavily distorted, showing numerical damping or energy increase.
It is a direct consequence of the low resolution of the discretization and instability of the method.</p></li>
</ol>
<p>100 Steps</p>
<p><a class="reference internal" href="_images/phase_plot_100_12.57.png"><img alt="_images/phase_plot_100_12.57.png" src="_images/phase_plot_100_12.57.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_100_12.57.png"><img alt="_images/time_evo_100_12.57.png" src="_images/time_evo_100_12.57.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 100 steps, end time 12.57.</p>
<p><a class="reference internal" href="_images/phase_plot_100_62.83.png"><img alt="_images/phase_plot_100_62.83.png" src="_images/phase_plot_100_62.83.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_100_62.83.png"><img alt="_images/time_evo_100_62.83.png" src="_images/time_evo_100_62.83.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 100 steps, end time 62.83.</p>
<p><a class="reference internal" href="_images/phase_plot_100_314.16.png"><img alt="_images/phase_plot_100_314.16.png" src="_images/phase_plot_100_314.16.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_100_314.16.png"><img alt="_images/time_evo_100_314.16.png" src="_images/time_evo_100_314.16.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 100 steps, end time 314.16.</p>
<p>1000 Steps</p>
<p><a class="reference internal" href="_images/phase_plot_1000_12.57.png"><img alt="_images/phase_plot_1000_12.57.png" src="_images/phase_plot_1000_12.57.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_1000_12.57.png"><img alt="_images/time_evo_1000_12.57.png" src="_images/time_evo_1000_12.57.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 1000 steps, end time 12.57.</p>
<p><a class="reference internal" href="_images/phase_plot_1000_62.83.png"><img alt="_images/phase_plot_1000_62.83.png" src="_images/phase_plot_1000_62.83.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_1000_62.83.png"><img alt="_images/time_evo_1000_62.83.png" src="_images/time_evo_1000_62.83.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 1000 steps, end time 62.83.</p>
<p><a class="reference internal" href="_images/phase_plot_1000_314.16.png"><img alt="_images/phase_plot_1000_314.16.png" src="_images/phase_plot_1000_314.16.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_1000_314.16.png"><img alt="_images/time_evo_1000_314.16.png" src="_images/time_evo_1000_314.16.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 1000 steps, end time 314.16.</p>
<ol class="arabic simple" start="2">
<li><p><strong>Medium step sizes (τ = 100, 1000)</strong><br />
As the time step decreases, the phase portraits become smoother and more symmetric. In the plots we can nicely see, that the explicit Euler Method increases in amplitude, while the implicit Euler Method decreases over time. This is especially noticable in the plots where the End Time is set to 314.16 seconds.</p></li>
</ol>
<p>10000 steps</p>
<p><a class="reference internal" href="_images/phase_plot_10000_12.57.png"><img alt="_images/phase_plot_10000_12.57.png" src="_images/phase_plot_10000_12.57.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_10000_12.57.png"><img alt="_images/time_evo_10000_12.57.png" src="_images/time_evo_10000_12.57.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 10000 steps, end time 12.57.</p>
<p><a class="reference internal" href="_images/phase_plot_10000_62.83.png"><img alt="_images/phase_plot_10000_62.83.png" src="_images/phase_plot_10000_62.83.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_10000_62.83.png"><img alt="_images/time_evo_10000_62.83.png" src="_images/time_evo_10000_62.83.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 10000 steps, end time 62.83.</p>
<p><a class="reference internal" href="_images/phase_plot_10000_314.16.png"><img alt="_images/phase_plot_10000_314.16.png" src="_images/phase_plot_10000_314.16.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_10000_314.16.png"><img alt="_images/time_evo_10000_314.16.png" src="_images/time_evo_10000_314.16.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 10000 steps, end time 314.16.</p>
<p>100000 steps</p>
<p><a class="reference internal" href="_images/phase_plot_100000_12.57.png"><img alt="_images/phase_plot_100000_12.57.png" src="_images/phase_plot_100000_12.57.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_100000_12.57.png"><img alt="_images/time_evo_100000_12.57.png" src="_images/time_evo_100000_12.57.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 100000 steps, end time 12.57.</p>
<p><a class="reference internal" href="_images/phase_plot_100000_62.83.png"><img alt="_images/phase_plot_100000_62.83.png" src="_images/phase_plot_100000_62.83.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_100000_62.83.png"><img alt="_images/time_evo_100000_62.83.png" src="_images/time_evo_100000_62.83.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 100000 steps, end time 62.83.</p>
<p><a class="reference internal" href="_images/phase_plot_100000_314.16.png"><img alt="_images/phase_plot_100000_314.16.png" src="_images/phase_plot_100000_314.16.png" style="width: 350px;" /></a> <a class="reference internal" href="_images/time_evo_100000_314.16.png"><img alt="_images/time_evo_100000_314.16.png" src="_images/time_evo_100000_314.16.png" style="width: 350px;" /></a></p>
<p>Phase portrait and time evolution for 100000 steps, end time 314.16.</p>
<ol class="arabic" start="3">
<li><p><strong>Very small step sizes (τ = 10000, 100000)</strong><br />
For the smallest step size considered, the phase curves converge toward the analytical solution.<br />
The trajectories become closed and circular, indicating stable long term behavior and good energy conservation. Altough on both plots with End Time = 314.16s, the explicit Euler Method again increases in Amplitude, showing that even at extremely small step sizes the method is not energy-preserving and accumulates a systematic energy error over long integration times.</p>
<h3 class="rubric" id="overall-conclusions">Overall Conclusions</h3>
</li>
</ol>
<p>As we can see in the plots, for very large τ, the waveform becomes visibly jagged. Even if we increase the number of steps, some time evolution plots show growing amplitude, others show damped amplitude, depending on the Numeric Method used. For example the explicit Euler method injects energy, therefore resulting in a growing amplitude. In contrast,the implicit Euler Method is both A-stable and L-stable. It has built in dampening, which dissipates energy and causes dampening over time.
The Crank-Nicholson Method is energy preserving, therefore the oscillations will continue without dampening or amplification.</p>
<p>For τ = 100000, the numerical time evolution is smooth and closely matches the expected sinusoidal behavior.  This demonstrates the expected convergence behavior of the integrators: as τ decreases, the numerical error shrinks at the rate predicted by the theoretical order of the method.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">NSSC1 Numerical Methods for Ordinary Differential Equations Exercises Part 1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#explicit-euler-method">Explicit Euler Method</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-euler-method">Implicit Euler Method</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#improved-euler-method">Improved Euler Method</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#crank-nicolson-method">Crank-Nicolson Method</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-plots">Interpretation of Plots</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Joe Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>